# Development override file
# This file is automatically loaded by docker-compose for development
# Use: docker-compose up -d (will load both docker-compose.yml and this override)

services:
  # Override app service for development
  app:
    volumes:
      - ./src:/app/src
      - ./logs:/app/logs
      - ./tests:/app/tests
      - ./docs:/app/docs
    environment:
      - DEBUG=true
      - LOG_LEVEL=DEBUG
      - PYTHONPATH=/app/src
    command: uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
    stdin_open: true
    tty: true

  # Override database for development
  db:
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=stratlogic
      - POSTGRES_INITDB_ARGS=--encoding=UTF-8
    volumes:
      - postgres_data:/var/lib/postgresql/data/
      - ./scripts/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql:ro

  # Override Redis for development
  redis:
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data

  # Override MinIO for development
  minio:
    environment:
      - MINIO_ROOT_USER=minioadmin
      - MINIO_ROOT_PASSWORD=minioadmin
    volumes:
      - minio_data:/data
      - ./scripts/minio-init.sh:/docker-entrypoint-initdb.d/minio-init.sh:ro

volumes:
  postgres_data:
  redis_data:
  minio_data:
